"use strict";(self.webpackChunkjupyterlab_gather=self.webpackChunkjupyterlab_gather||[]).push([[427],{3427:(e,n,t)=>{t.r(n),t.d(n,{useFilePicker:()=>S,useImperativeFilePicker:()=>P});var r=t(9852),i=t(3345);function a(e,n,t,r){return new(t||(t=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function l(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,l)}u((r=r.apply(e,n||[])).next())}))}function o(e,n){var t,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(u){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(o=0)),o;)try{if(t=1,r&&(i=2&l[0]?r.return:l[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,l[1])).done)return i;switch(r=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){o.label=l[1];break}if(6===l[0]&&o.label<i[1]){o.label=i[1],i=l;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(l);break}i[2]&&o.ops.pop(),o.trys.pop();continue}l=n.call(e,o)}catch(e){l=[6,e],r=0}finally{t=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}}function l(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var r,i,a=t.call(e),o=[];try{for(;(void 0===n||n-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(t=a.return)&&t.call(a)}finally{if(i)throw i.error}}return o}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var u=new Map([["avi","video/avi"],["gif","image/gif"],["ico","image/x-icon"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["mkv","video/x-matroska"],["mov","video/quicktime"],["mp4","video/mp4"],["pdf","application/pdf"],["png","image/png"],["zip","application/zip"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"]]);function c(e,n){var t=function(e){var n=e.name;if(n&&-1!==n.lastIndexOf(".")&&!e.type){var t=n.split(".").pop().toLowerCase(),r=u.get(t);r&&Object.defineProperty(e,"type",{value:r,writable:!1,configurable:!1,enumerable:!0})}return e}(e);if("string"!=typeof t.path){var r=e.webkitRelativePath;Object.defineProperty(t,"path",{value:"string"==typeof n?n:"string"==typeof r&&r.length>0?r:e.name,writable:!1,configurable:!1,enumerable:!0})}return t}var s=[".DS_Store","Thumbs.db"];function f(e){return a(this,void 0,void 0,(function(){return o(this,(function(n){return[2,(t=e,t.dataTransfer&&e.dataTransfer?d(e.dataTransfer,e.type):p(e))];var t}))}))}function p(e){return(null!==e.target&&e.target.files?h(e.target.files):[]).map((function(e){return c(e)}))}function d(e,n){return a(this,void 0,void 0,(function(){var t;return o(this,(function(r){switch(r.label){case 0:return e.items?(t=h(e.items).filter((function(e){return"file"===e.kind})),"drop"!==n?[2,t]:[4,Promise.all(t.map(m))]):[3,2];case 1:return[2,v(b(r.sent()))];case 2:return[2,v(h(e.files).map((function(e){return c(e)})))]}}))}))}function v(e){return e.filter((function(e){return-1===s.indexOf(e.name)}))}function h(e){for(var n=[],t=0;t<e.length;t++){var r=e[t];n.push(r)}return n}function m(e){if("function"!=typeof e.webkitGetAsEntry)return y(e);var n=e.webkitGetAsEntry();return n&&n.isDirectory?F(n):y(e)}function b(e){return e.reduce((function(e,n){return function(){for(var e=[],n=0;n<arguments.length;n++)e=e.concat(l(arguments[n]));return e}(e,Array.isArray(n)?b(n):[n])}),[])}function y(e){var n=e.getAsFile();if(!n)return Promise.reject(e+" is not a File");var t=c(n);return Promise.resolve(t)}function g(e){return a(this,void 0,void 0,(function(){return o(this,(function(n){return[2,e.isDirectory?F(e):k(e)]}))}))}function F(e){var n=e.createReader();return new Promise((function(e,t){var r=[];!function i(){var l=this;n.readEntries((function(n){return a(l,void 0,void 0,(function(){var a,l,u;return o(this,(function(o){switch(o.label){case 0:if(n.length)return[3,5];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,Promise.all(r)];case 2:return a=o.sent(),e(a),[3,4];case 3:return l=o.sent(),t(l),[3,4];case 4:return[3,6];case 5:u=Promise.all(n.map(g)),r.push(u),i(),o.label=6;case 6:return[2]}}))}))}),(function(e){t(e)}))}()}))}function k(e){return a(this,void 0,void 0,(function(){return o(this,(function(n){return[2,new Promise((function(n,t){e.file((function(t){var r=c(t,e.fullPath);n(r)}),(function(e){t(e)}))}))]}))}))}var w=function(e){var n=e.onFilesSelected,t=e.onFilesSuccessfullySelected,r=e.onFilesRejected,a=e.onClear,o=e.validators;return{onFilesSelected:(0,i.useCallback)((function(e){null==n||n(e),null==o||o.forEach((function(n){n.onFilesSelected(e)}))}),[n,o]),onFilesSuccessfullySelected:(0,i.useCallback)((function(e){null==t||t(e),null==o||o.forEach((function(n){n.onFilesSuccessfullySelected(e)}))}),[o,t]),onFilesRejected:(0,i.useCallback)((function(e){null==r||r(e),null==o||o.forEach((function(n){n.onFilesRejected(e)}))}),[o,r]),onClear:(0,i.useCallback)((function(){null==a||a(),null==o||o.forEach((function(e){null==e.onClear||e.onClear()}))}),[o,a])}},C=[];function S(e){var n=e.accept,t=void 0===n?"*":n,a=e.multiple,o=void 0===a||a,l=e.readAs,u=void 0===l?"Text":l,c=e.readFilesContent,s=void 0===c||c,p=e.validators,d=void 0===p?C:p,v=e.initializeWithCustomParameters,h=(0,i.useState)([]),m=h[0],b=h[1],y=(0,i.useState)([]),g=y[0],F=y[1],k=(0,i.useState)([]),S=k[0],P=k[1],x=(0,i.useState)(!1),j=x[0],E=x[1],A=w(e),R=A.onFilesSelected,O=A.onFilesSuccessfullySelected,T=A.onFilesRejected,_=A.onClear,B=(0,i.useCallback)((function(){b([]),F([]),P([])}),[]),I=(0,i.useCallback)((function(){B(),null==_||_()}),[B,_]),M=(0,i.useCallback)((function(n){return new Promise(function(){var t=(0,r._)((0,r.a)().mark((function t(i,a){var o,l;return(0,r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(o=new FileReader)["readAs"+u].call(o,n),l=function(e){var n=(0,r.b)({},((0,r.c)(e),e));a((0,r.b)({},n))},o.onload=(0,r._)((0,r.a)().mark((function t(){return(0,r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.all(d.map((function(t){return t.validateAfterParsing(e,n,o).catch((function(e){return Promise.reject(l(e))}))}))).then((function(){return i((0,r.b)({},n,{content:o.result,name:n.name,lastModified:n.lastModified}))})).catch((function(){})));case 1:case"end":return t.stop()}}),t)}))),o.onerror=function(){l({name:"FileReaderError",readerError:o.error,causedByFile:n})};case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}),[e,u,d]),z=(0,i.useCallback)((function(){!function(e,n,t,r){var i=document.createElement("input");i.style.display="none",document.body.appendChild(i),i.type="file","*"!==e&&(i.accept=e),i.multiple=n,i.addEventListener("change",(function(e){t(e),document.body.removeChild(i)})),r&&r(i),i.dispatchEvent(new MouseEvent("click"))}(t instanceof Array?t.join(","):t,o,function(){var n=(0,r._)((0,r.a)().mark((function n(t){var i,a,o,l,u,c;return(0,r.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return B(),i=t.target,a=i.files?Array.from(i.files):[],E(!0),n.next=6,Promise.all(d.map((function(n){return n.validateBeforeParsing(e,a).catch((function(e){return Array.isArray(e)?e:[e]}))})));case 6:if(o=n.sent.flat(1).filter(Boolean),b(a),P(o),!o.length){n.next=15;break}return E(!1),b([]),null==T||T({errors:o}),null==R||R({errors:o}),n.abrupt("return");case 15:if(s){n.next=19;break}return E(!1),null==R||R({plainFiles:a,filesContent:[]}),n.abrupt("return");case 19:return n.next=21,f(t);case 21:return l=n.sent,u=[],n.next=25,Promise.all(l.map((function(e){return M(e).catch((function(e){u.push.apply(u,Array.isArray(e)?e:[e])}))})));case 25:if(c=n.sent,E(!1),!u.length){n.next=34;break}return b([]),F([]),P((function(e){return[].concat(e,u)})),null==T||T({errors:u}),null==R||R({errors:o.concat(u)}),n.abrupt("return");case 34:F(c),b(a),P([]),null==O||O({filesContent:c,plainFiles:a}),null==R||R({plainFiles:a,filesContent:c});case 39:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),v)}),[e,t,B,v,o,T,R,O,M,s,d]);return{openFilePicker:z,filesContent:g,errors:S,loading:j,plainFiles:m,clear:I}}function P(e){var n=e.onFilesSelected,t=e.onFilesSuccessfullySelected,a=e.validators,o=e.onFileRemoved,l=(0,i.useState)([]),u=l[0],c=l[1],s=(0,i.useState)([]),f=s[0],p=s[1],d=S((0,r.b)({},e,{onFilesSelected:function(e){var t;if(n)return null!=(t=e.errors)&&t.length?n(e):void n({errors:void 0,plainFiles:[].concat(u,e.plainFiles||[]),filesContent:[].concat(f,e.filesContent||[])})},onFilesSuccessfullySelected:function(e){c((function(n){return n.concat(e.plainFiles)})),p((function(n){return n.concat(e.filesContent)})),t&&t({plainFiles:[].concat(u,e.plainFiles||[]),filesContent:[].concat(f,e.filesContent||[])})}})),v=d.openFilePicker,h=d.loading,m=d.errors,b=d.clear,y=(0,i.useCallback)((function(){b(),c([]),p([])}),[b]),g=(0,i.useCallback)((function(e){p((function(n){return[].concat(n.slice(0,e),n.slice(e+1))})),c((function(n){var t=n[e];return null==a||a.forEach((function(n){return null==n.onFileRemoved?void 0:n.onFileRemoved(t,e)})),null==o||o(t,e),[].concat(n.slice(0,e),n.slice(e+1))}))}),[a,o]),F=(0,i.useCallback)((function(e){var n=u.findIndex((function(n){return n===e}));-1!==n&&g(n)}),[g,u]);return{openFilePicker:v,plainFiles:u,filesContent:f,loading:h,errors:m,clear:y,removeFileByIndex:g,removeFileByReference:F}}}}]);