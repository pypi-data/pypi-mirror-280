"use strict";(self.webpackChunkephemeral_notebooks=self.webpackChunkephemeral_notebooks||[]).push([[509],{509:(o,e,t)=>{t.r(e),t.d(e,{default:()=>d});var n=t(212),a=t(605),c=t(984),l=t(262),r=t(381),s=t(268);console.log("notebook_to_url_ext is loaded!"),console.log("Notebook:",a.Notebook),console.log("NotebookActions:",a.NotebookActions);let i=null;new URLSearchParams(window.location.search);const d={id:"urlify-notebook",autoStart:!0,requires:[s.IFileBrowserFactory,c.IRouter,a.INotebookTracker],activate:(o,e,t,a)=>{t.register({command:"notebook:start-nav",pattern:/(tempNotebook=1)/,rank:20}),function(o,e){const t=new r.ToolbarButton({label:"Save to URL",onClick:()=>{const o=e.currentWidget;o&&function(o){console.log("notebook panel",o,o.context.model.toJSON());const e=JSON.stringify(o.context.model.toJSON()),t=n.compressToEncodedURIComponent(e),a=new URL(window.location.href);a.pathname.includes("retro/notebooks/index.html")&&(a.pathname=a.pathname.replace("retro/notebooks/index.html","lab/index.html")),a.hash=`notebook=${t}`,a.searchParams.set("tempNotebook","1"),a.searchParams.set("path","temp.ipynb"),console.log("new url",a,a.toString());const c=a.toString();r.Clipboard.copyToSystem(c),alert("URL copied to clipboard")}(o)},tooltip:"Save notebook content to URL and copy to clipboard"});e.widgetAdded.connect(((o,e)=>{e.toolbar.insertItem(10,"saveToUrl",t)}))}(0,a),function(){const o=new URLSearchParams(window.location.hash.slice(1));i=o,console.log("Saved URL parameters:",i.toString())}(),function(o,e,t){if(t){function a(o){const e=new URL(window.location.href),t=(e.search,e.hash,window.location.href.match(/(.*\/)lab\/index\.html/));let n=(t?t[1]:"")+`notebooks/index.html?path=${o}&${o}&${e.search}&${e.hash}`;console.log("retro",n),window.location.href=n}console.log("router",t),o.commands.addCommand("notebook:start-nav",{label:"Open Temp Notebook from URL",execute:async e=>{const{request:n}=e;console.log("in request",e,n);const a=new URL(`http://example.com${n}`).searchParams.get("tempNotebook");console.log("displayName",a);const c=async()=>{t.routed.disconnect(c);const{request:e}=t.current;console.log("chat after",a),1==a&&(console.log("in request",e),await o.commands.execute("notebook:open-temp",{url:"/temp-notebook"}))};t.routed.connect(c)}}),o.commands.addCommand("notebook:open-temp",{label:"Open Temporary Notebook",execute:async t=>{var c,r;console.log("executing create new");const s=null!==(c=null==e?void 0:e.tracker.currentWidget)&&void 0!==c?c:e.defaultBrowser,d=t.cwd||(null!==(r=null==s?void 0:s.model.path)&&void 0!==r?r:""),m=t.kernelId||"",p=t.kernelName||"",u=await(async(e,t,c)=>{const r=await o.commands.execute("docmanager:new-untitled",{path:e,type:"notebook"});if(console.log("created model",r),void 0!==r){const e=await o.commands.execute("docmanager:open",{path:r.path,factory:"Notebook",kernel:{id:t,name:c}});e.isUntitled=!0;const s=`temp-notebook-${l.UUID.uuid4()}`;await e.context.rename(s+".ipynb"),console.log("widget",e,e.context.path);const d=function(){if(i){console.log("savedParams",i.get("notebook"));const o=i.get("notebook");if(o){const e=n.decompressFromEncodedURIComponent(o),t=JSON.parse(e);return console.log("decompressedContent",t),t}}return null}();if(console.log("content",d),d){const o=e.context.model;console.log("model",o),o.fromJSON(d),await e.context.save(),console.log("Notebook content saved.")}return a(e.context.path),e}})(d,m,p);console.log("created model",u,d,"kernel",m,"kernelName",p)}})}}(o,e,t)}}}}]);