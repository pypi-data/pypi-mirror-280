From 71820ebc8fff55bbfaaaa79b14d1f84a207c7d0b Mon Sep 17 00:00:00 2001
From: Marc Soda <marc@soda.fm>
Date: Sun, 23 Jun 2024 18:22:24 -0400
Subject: [PATCH 1/3] read fasta

---
 src/psicalc/psicalc.py | 30 +++++++++++++++++++++++++++++-
 1 file changed, 29 insertions(+), 1 deletion(-)

diff --git a/src/psicalc/psicalc.py b/src/psicalc/psicalc.py
index 1775e2c..03e49cc 100644
--- a/src/psicalc/psicalc.py
+++ b/src/psicalc/psicalc.py
@@ -115,7 +115,7 @@ def check_for_duplicates(df: pd.DataFrame) -> pd.DataFrame:
 
 
 def read_txt_file_format(file) -> pd.DataFrame:
-    """Reads FASTA files or text file-based MSAs into a dataframe."""
+    """Reads text file-based MSAs into a dataframe."""
     id, seq = [], []
     with open(file, "r") as fasta_file:
         for line in fasta_file:
@@ -136,6 +136,34 @@ def read_txt_file_format(file) -> pd.DataFrame:
     return df
 
 
+def read_fasta_file_format(file) -> pd.DataFrame:
+    """Reads FASTA files or text file-based MSAs into a dataframe."""
+    ids, sequences = [], []
+    with open(file, "r") as fasta_file:
+        data = []
+        for line in fasta_file:
+            if line.startswith(">"):
+                if ids:
+                    sequences.append(data)
+                    data = []
+                ids.append(line.strip(">").strip())
+            elif line:
+                data.extend(line.strip())
+
+        sequences.append(data)
+        res = list(zip(ids, sequences))
+
+    nucs_dict = dict(res)
+
+    df = pd.DataFrame.from_dict(nucs_dict, orient='index')
+    df = df.replace({'.': '-'})
+    df.index.name = 'SEQUENCE_ID'
+    df = check_for_duplicates(df)
+    df.fillna('?', inplace=True)
+
+    return df
+
+
 def read_csv_file_format(file) -> pd.DataFrame:
     """Reads CSV MSAs into a dataframe."""
     df = pd.read_csv(file, encoding='utf-8', header=None, dtype=str)
-- 
2.39.3 (Apple Git-146)

