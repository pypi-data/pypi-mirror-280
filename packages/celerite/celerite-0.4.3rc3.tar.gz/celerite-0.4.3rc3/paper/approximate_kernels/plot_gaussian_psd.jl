# Plots power spectrum components of approximate Gaussian PSD:
using PyPlot

#nc = 4
#amp = [2.953823582534889, -0.04961614737314587, -1.6900719772140012, -0.21413545794774125]
#b =[1.589510614489265, 3.4729345651560872, 1.8698492189074047, 6.363451205766626]
#omega =[0.3329119766576696, 4.5999414581901386,1.7115890219170917, 2.205939216106191]
#amp = [2.953823582534889, -0.04961614737314587, -0.21413545794774125, -1.690719772140012]
#b =[1.589510614489265, 3.4729345651560872, 6.363451205766626, 1.8698492189074047]
#omega =[0.3329119766576696, 4.5999414581901386, 2.205939216106191,1.1115890219170917]

nc = 3
amp = [2.670143,-0.458705,-1.211438]
b = [1.500258,4.125558,1.744602]
omega = [0.346731,1.390912,1.798436]

nf = 100
f = 2*pi*logspace(-2,2,nf)
psdtot =  zeros(nf)
for i=1:nc
  psd = amp[i]*b[i]*sqrt(2./pi)*(b[i]^2+omega[i]^2+f.^2)./(b[i]^4+(omega[i]^2-f.^2).^2+2.*b[i]^2.*(omega[i]^2+f[i]^2))
  loglog(f,abs(psd))
  psdtot += psd
  loglog(f,psdtot,linestyle="dashed")
  read(STDIN,Char)
end

#plot(f,psdtot)
