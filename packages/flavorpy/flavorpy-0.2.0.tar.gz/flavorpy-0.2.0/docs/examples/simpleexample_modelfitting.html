

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Simple example &#8212; FlavorPy 0.2.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/simpleexample_modelfitting';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">FlavorPy 0.2.0 documentation</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../constructterms.html">
                        ConstructTerms
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../modelfitting.html">
                        ModelFitting
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="examples_page.html">
                        Examples
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/flavorpy/flavorpy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../constructterms.html">
                        ConstructTerms
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../modelfitting.html">
                        ModelFitting
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="examples_page.html">
                        Examples
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/flavorpy/flavorpy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Simple example</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="simple-example">
<h1>Simple example<a class="headerlink" href="#simple-example" title="Permalink to this heading">#</a></h1>
<p>This example is supposed to serve as a quick start to the ModelFitting
module of FlavorPy.</p>
<section id="import-flavorpy">
<h2>Import FlavorPy<a class="headerlink" href="#import-flavorpy" title="Permalink to this heading">#</a></h2>
<p>After installing FlavorPy with
<code class="code docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">flavorpy</span></code>,
import the modelfitting module.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the modelfitting module of FlavorPy</span>
<span class="kn">import</span> <span class="nn">flavorpy.modelfitting</span> <span class="k">as</span> <span class="nn">mf</span>

<span class="c1"># We will also need numpy and pandas</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</section>
<section id="defining-mass-matrices">
<h2>Defining mass matrices<a class="headerlink" href="#defining-mass-matrices" title="Permalink to this heading">#</a></h2>
<p>To define a model of leptons, we start by defining its mass matrices</p>
<p><span class="math notranslate nohighlight">\(M_e = \begin{pmatrix} 0.0048\times0.0565 &amp; 0 &amp; 0 \\ 0 &amp; 0.0565 &amp; 0 \\ 0 &amp; 0 &amp; 1\end{pmatrix} \quad\)</span>
and
<span class="math notranslate nohighlight">\(\quad M_n = \begin{pmatrix} 1 &amp; v_2 &amp; v_3 \\ v_1 &amp; 1 &amp; v_3 \\ v_1 &amp; v_2 &amp; 1\end{pmatrix}\)</span></p>
<p>For this example we have:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Charged lepton mass matrix</span>
<span class="k">def</span> <span class="nf">Me</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0048</span><span class="o">*</span><span class="mf">0.0565</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0565</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="c1"># Neutrino mass matrix</span>
<span class="k">def</span> <span class="nf">Mn</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">],</span> <span class="p">[</span><span class="n">v1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">v3</span><span class="p">],</span> <span class="p">[</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</section>
<section id="defining-parameterspace">
<h2>Defining parameterspace<a class="headerlink" href="#defining-parameterspace" title="Permalink to this heading">#</a></h2>
<p>Next, we define the parameterspace of our model. We therefore construct
an empty parameter space and add the parameters to it. When fitting, we will
draw random points within this parameter space.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ParamSpace</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">ParameterSpace</span><span class="p">()</span>
<span class="n">ParamSpace</span><span class="o">.</span><span class="n">add_dim</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;v1&#39;</span><span class="p">)</span>
<span class="n">ParamSpace</span><span class="o">.</span><span class="n">add_dim</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;v2&#39;</span><span class="p">)</span>
<span class="n">ParamSpace</span><span class="o">.</span><span class="n">add_dim</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;v3&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="constructing-model">
<h2>Constructing Model<a class="headerlink" href="#constructing-model" title="Permalink to this heading">#</a></h2>
<p>Then we can construct the lepton model as follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MyModel</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">FlavorModel</span><span class="p">(</span><span class="n">mass_matrix_e</span><span class="o">=</span><span class="n">Me</span><span class="p">,</span> <span class="n">mass_matrix_n</span><span class="o">=</span><span class="n">Mn</span><span class="p">,</span> <span class="n">parameterspace</span><span class="o">=</span><span class="n">ParamSpace</span><span class="p">,</span> <span class="n">ordering</span><span class="o">=</span><span class="s1">&#39;NO&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can determine the masses and mixing observables of a given point
in parameter space by:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MyModel</span><span class="o">.</span><span class="n">get_obs</span><span class="p">({</span><span class="s1">&#39;v1&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;v2&#39;</span><span class="p">:</span> <span class="mf">1.1</span><span class="p">,</span> <span class="s1">&#39;v3&#39;</span><span class="p">:</span> <span class="mf">1.3</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;me/mu&#39;</span><span class="p">:</span> <span class="mf">0.0048</span><span class="p">,</span>
 <span class="s1">&#39;mu/mt&#39;</span><span class="p">:</span> <span class="mf">0.0565</span><span class="p">,</span>
 <span class="s1">&#39;s12^2&#39;</span><span class="p">:</span> <span class="mf">0.9053720503789906</span><span class="p">,</span>
 <span class="s1">&#39;s13^2&#39;</span><span class="p">:</span> <span class="mf">0.2893377761696659</span><span class="p">,</span>
 <span class="s1">&#39;s23^2&#39;</span><span class="p">:</span> <span class="mf">0.5280465699834944</span><span class="p">,</span>
 <span class="s1">&#39;d/pi&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="mf">0.010306101829667999</span><span class="p">,</span>
 <span class="s1">&#39;m21^2&#39;</span><span class="p">:</span> <span class="mf">4.9968698643488846e-05</span><span class="p">,</span>
 <span class="s1">&#39;m3l^2&#39;</span><span class="p">:</span> <span class="mf">0.0048484576874298696</span><span class="p">,</span>
 <span class="s1">&#39;m1&#39;</span><span class="p">:</span> <span class="mf">0.0033969202435270816</span><span class="p">,</span>
 <span class="s1">&#39;m2&#39;</span><span class="p">:</span> <span class="mf">0.007842688683377208</span><span class="p">,</span>
 <span class="s1">&#39;m3&#39;</span><span class="p">:</span> <span class="mf">0.06971367695488995</span><span class="p">,</span>
 <span class="s1">&#39;eta1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
 <span class="s1">&#39;eta2&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
 <span class="s1">&#39;J&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s1">&#39;Jmax&#39;</span><span class="p">:</span> <span class="mf">0.05585663171203268</span><span class="p">,</span>
 <span class="s1">&#39;Sum(m_i)&#39;</span><span class="p">:</span> <span class="mf">0.08095328588179423</span><span class="p">,</span>
 <span class="s1">&#39;m_b&#39;</span><span class="p">:</span> <span class="mf">0.03822289118358137</span><span class="p">,</span>
 <span class="s1">&#39;m_bb&#39;</span><span class="p">:</span> <span class="mf">0.025548760738177294</span><span class="p">,</span>
 <span class="s1">&#39;nscale&#39;</span><span class="p">:</span> <span class="mf">0.019258907884260646</span><span class="p">}</span>
</pre></div>
</div>
<p>Here, ‘me/mu’ is the mass ratio of electron mass divided by muon mass,
‘sij^2’ refers to the mixing angles <span class="math notranslate nohighlight">\(\sin^2(\theta_{ij})\)</span>, ‘d/pi’
is the cp violating phase in the PMNS matrix divided by <span class="math notranslate nohighlight">\(\pi\)</span>,
‘m21^2’ and ‘m3l^2’ and the squared neutrino mass differences,
i.e. mij^2 = m_i^2 - m_j^2, ‘r’ is their quotient r = m21^2 / m3l^2,
‘m1’ and ‘m2’ and ‘m3’ are the neutrino masses, ‘eta1’ and ‘eta2’ are
the majorana phases, ‘J’ is the Jarskog determinant, ‘m_b’ and ‘m_bb’
are the effective neutrino masses for beta decay and neutrinoless double
beta decay, respectively.</p>
</section>
<section id="fitting-model-to-experimental-data">
<h2>Fitting model to experimental data<a class="headerlink" href="#fitting-model-to-experimental-data" title="Permalink to this heading">#</a></h2>
<p>Let us now fit this model to a specific experimental data set. As a
default the NuFit v5.3 for NO with SK data is used. To fit this model we
choose for example 3 randomly drawn points in the parameter space and
apply minimization algorithms to these points, in order to find a point
that matches the experimental data well. Note that by default 4
minimization algorithms are applied consecutively to all 3 random points
such that we get 12 points in the end.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># This pandas setting allows us to see all columns</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">MyModel</span><span class="o">.</span><span class="n">make_fit</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th></th>
      <th style="min-width: 120px;">chisq</th>
      <th style="min-width: 120px;">chisq_dimless</th>
      <th style="min-width: 90px;">v1</th>
      <th style="min-width: 90px;">v2</th>
      <th style="min-width: 90px;">v3</th>
      <th>n_scale</th>
      <th style="min-width: 90px;">me/mu</th>
      <th style="min-width: 90px;">mu/mt</th>
      <th style="min-width: 90px;">s12^2</th>
      <th style="min-width: 90px;">s13^2</th>
      <th style="min-width: 90px;">s23^2</th>
      <th style="min-width: 50px;">d/pi</th>
      <th style="min-width: 90px;">r</th>
      <th style="min-width: 90px;">m21^2</th>
      <th style="min-width: 90px;">m3l^2</th>
      <th style="min-width: 90px;">m1</th>
      <th style="min-width: 90px;">m2</th>
      <th style="min-width: 90px;">m3</th>
      <th>eta1</th>
      <th>eta2</th>
      <th style="min-width: 120px;">J</th>
      <th style="min-width: 90px;">Jmax</th>
      <th style="min-width: 90px;">Sum(m_i)</th>
      <th style="min-width: 90px;">m_b</th>
      <th style="min-width: 90px;">m_bb</th>
      <th style="min-width: 90px;">nscale</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.651948</td>
      <td>5.651702</td>
      <td>5.036863</td>
      <td>-0.528403</td>
      <td>0.701039</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.305000</td>
      <td>0.022200</td>
      <td>0.499957</td>
      <td>1.0</td>
      <td>0.029596</td>
      <td>0.000074</td>
      <td>0.002505</td>
      <td>0.002326</td>
      <td>0.008920</td>
      <td>0.050108</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.107236e-18</td>
      <td>0.033538</td>
      <td>0.061353</td>
      <td>0.009208</td>
      <td>0.005369</td>
      <td>0.006852</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.651948</td>
      <td>5.651702</td>
      <td>5.036863</td>
      <td>-0.528403</td>
      <td>0.701039</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.305000</td>
      <td>0.022200</td>
      <td>0.499957</td>
      <td>1.0</td>
      <td>0.029596</td>
      <td>0.000074</td>
      <td>0.002505</td>
      <td>0.002326</td>
      <td>0.008920</td>
      <td>0.050108</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.107236e-18</td>
      <td>0.033538</td>
      <td>0.061353</td>
      <td>0.009208</td>
      <td>0.005369</td>
      <td>0.006852</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5.651948</td>
      <td>5.651702</td>
      <td>5.036863</td>
      <td>-0.528403</td>
      <td>0.701039</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.305000</td>
      <td>0.022200</td>
      <td>0.499957</td>
      <td>1.0</td>
      <td>0.029596</td>
      <td>0.000074</td>
      <td>0.002505</td>
      <td>0.002326</td>
      <td>0.008920</td>
      <td>0.050108</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.107236e-18</td>
      <td>0.033538</td>
      <td>0.061353</td>
      <td>0.009208</td>
      <td>0.005369</td>
      <td>0.006852</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.651948</td>
      <td>5.651702</td>
      <td>5.036863</td>
      <td>-0.528403</td>
      <td>0.701039</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.305000</td>
      <td>0.022200</td>
      <td>0.499957</td>
      <td>1.0</td>
      <td>0.029596</td>
      <td>0.000074</td>
      <td>0.002505</td>
      <td>0.002326</td>
      <td>0.008920</td>
      <td>0.050108</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.107236e-18</td>
      <td>0.033538</td>
      <td>0.061353</td>
      <td>0.009208</td>
      <td>0.005369</td>
      <td>0.006852</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.655930</td>
      <td>5.655555</td>
      <td>5.049672</td>
      <td>-0.534924</td>
      <td>0.713045</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.309623</td>
      <td>0.022200</td>
      <td>0.500035</td>
      <td>1.0</td>
      <td>0.029592</td>
      <td>0.000074</td>
      <td>0.002506</td>
      <td>0.002402</td>
      <td>0.008939</td>
      <td>0.050113</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.124460e-18</td>
      <td>0.033679</td>
      <td>0.061455</td>
      <td>0.009246</td>
      <td>0.005457</td>
      <td>0.006835</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5.655930</td>
      <td>5.655555</td>
      <td>5.049672</td>
      <td>-0.534924</td>
      <td>0.713045</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.309623</td>
      <td>0.022200</td>
      <td>0.500035</td>
      <td>1.0</td>
      <td>0.029592</td>
      <td>0.000074</td>
      <td>0.002506</td>
      <td>0.002402</td>
      <td>0.008939</td>
      <td>0.050113</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.124460e-18</td>
      <td>0.033679</td>
      <td>0.061455</td>
      <td>0.009246</td>
      <td>0.005457</td>
      <td>0.006835</td>
    </tr>
    <tr>
      <th>6</th>
      <td>5.655930</td>
      <td>5.655555</td>
      <td>5.049672</td>
      <td>-0.534924</td>
      <td>0.713045</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.309623</td>
      <td>0.022200</td>
      <td>0.500035</td>
      <td>1.0</td>
      <td>0.029592</td>
      <td>0.000074</td>
      <td>0.002506</td>
      <td>0.002402</td>
      <td>0.008939</td>
      <td>0.050113</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.124460e-18</td>
      <td>0.033679</td>
      <td>0.061455</td>
      <td>0.009246</td>
      <td>0.005457</td>
      <td>0.006835</td>
    </tr>
    <tr>
      <th>7</th>
      <td>5.657581</td>
      <td>5.657194</td>
      <td>5.041598</td>
      <td>-0.533464</td>
      <td>0.714117</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.309623</td>
      <td>0.022280</td>
      <td>0.500068</td>
      <td>1.0</td>
      <td>0.029592</td>
      <td>0.000074</td>
      <td>0.002506</td>
      <td>0.002413</td>
      <td>0.008942</td>
      <td>0.050114</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.131556e-18</td>
      <td>0.033737</td>
      <td>0.061469</td>
      <td>0.009260</td>
      <td>0.005469</td>
      <td>0.006845</td>
    </tr>
    <tr>
      <th>8</th>
      <td>5.657581</td>
      <td>5.657194</td>
      <td>5.041598</td>
      <td>-0.533464</td>
      <td>0.714117</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.309623</td>
      <td>0.022280</td>
      <td>0.500068</td>
      <td>1.0</td>
      <td>0.029592</td>
      <td>0.000074</td>
      <td>0.002506</td>
      <td>0.002413</td>
      <td>0.008942</td>
      <td>0.050114</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.131556e-18</td>
      <td>0.033737</td>
      <td>0.061469</td>
      <td>0.009260</td>
      <td>0.005469</td>
      <td>0.006845</td>
    </tr>
    <tr>
      <th>9</th>
      <td>5.657581</td>
      <td>5.657194</td>
      <td>5.041598</td>
      <td>-0.533464</td>
      <td>0.714117</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.309623</td>
      <td>0.022280</td>
      <td>0.500068</td>
      <td>1.0</td>
      <td>0.029592</td>
      <td>0.000074</td>
      <td>0.002506</td>
      <td>0.002413</td>
      <td>0.008942</td>
      <td>0.050114</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.131556e-18</td>
      <td>0.033737</td>
      <td>0.061469</td>
      <td>0.009260</td>
      <td>0.005469</td>
      <td>0.006845</td>
    </tr>
    <tr>
      <th>10</th>
      <td>5.657581</td>
      <td>5.657194</td>
      <td>5.041598</td>
      <td>-0.533464</td>
      <td>0.714117</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.309623</td>
      <td>0.022280</td>
      <td>0.500068</td>
      <td>1.0</td>
      <td>0.029592</td>
      <td>0.000074</td>
      <td>0.002506</td>
      <td>0.002413</td>
      <td>0.008942</td>
      <td>0.050114</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.131556e-18</td>
      <td>0.033737</td>
      <td>0.061469</td>
      <td>0.009260</td>
      <td>0.005469</td>
      <td>0.006845</td>
    </tr>
    <tr>
      <th>11</th>
      <td>5.658516</td>
      <td>5.658316</td>
      <td>5.050711</td>
      <td>-0.535313</td>
      <td>0.712793</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.309623</td>
      <td>0.022189</td>
      <td>0.500027</td>
      <td>1.0</td>
      <td>0.029604</td>
      <td>0.000074</td>
      <td>0.002505</td>
      <td>0.002400</td>
      <td>0.008940</td>
      <td>0.050108</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.123487e-18</td>
      <td>0.033671</td>
      <td>0.061447</td>
      <td>0.009243</td>
      <td>0.005455</td>
      <td>0.006833</td>
    </tr>
    <tr>
      <th>12</th>
      <td>14.019848</td>
      <td>14.013724</td>
      <td>5.028969</td>
      <td>0.702363</td>
      <td>-0.526542</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.305000</td>
      <td>0.022280</td>
      <td>0.500002</td>
      <td>0.0</td>
      <td>0.029570</td>
      <td>0.000074</td>
      <td>0.002506</td>
      <td>0.002339</td>
      <td>0.008921</td>
      <td>0.050119</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.033596</td>
      <td>0.061379</td>
      <td>0.009223</td>
      <td>0.005383</td>
      <td>0.006864</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14.019853</td>
      <td>14.013724</td>
      <td>5.028969</td>
      <td>0.702363</td>
      <td>-0.526542</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.305000</td>
      <td>0.022280</td>
      <td>0.500002</td>
      <td>0.0</td>
      <td>0.029570</td>
      <td>0.000074</td>
      <td>0.002506</td>
      <td>0.002339</td>
      <td>0.008921</td>
      <td>0.050119</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.033596</td>
      <td>0.061379</td>
      <td>0.009223</td>
      <td>0.005383</td>
      <td>0.006864</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14.019853</td>
      <td>14.013724</td>
      <td>5.028969</td>
      <td>0.702363</td>
      <td>-0.526542</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.305000</td>
      <td>0.022280</td>
      <td>0.500002</td>
      <td>0.0</td>
      <td>0.029570</td>
      <td>0.000074</td>
      <td>0.002506</td>
      <td>0.002339</td>
      <td>0.008921</td>
      <td>0.050119</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.033596</td>
      <td>0.061379</td>
      <td>0.009223</td>
      <td>0.005383</td>
      <td>0.006864</td>
    </tr>
    <tr>
      <th>15</th>
      <td>14.019853</td>
      <td>14.013724</td>
      <td>5.028969</td>
      <td>0.702363</td>
      <td>-0.526542</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.305000</td>
      <td>0.022280</td>
      <td>0.500002</td>
      <td>0.0</td>
      <td>0.029570</td>
      <td>0.000074</td>
      <td>0.002506</td>
      <td>0.002339</td>
      <td>0.008921</td>
      <td>0.050119</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.033596</td>
      <td>0.061379</td>
      <td>0.009223</td>
      <td>0.005383</td>
      <td>0.006864</td>
    </tr>
    <tr>
      <th>16</th>
      <td>14.020580</td>
      <td>14.014997</td>
      <td>5.028979</td>
      <td>0.702446</td>
      <td>-0.526597</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.305033</td>
      <td>0.022281</td>
      <td>0.500001</td>
      <td>0.0</td>
      <td>0.029571</td>
      <td>0.000074</td>
      <td>0.002506</td>
      <td>0.002340</td>
      <td>0.008921</td>
      <td>0.050119</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.033597</td>
      <td>0.061380</td>
      <td>0.009224</td>
      <td>0.005383</td>
      <td>0.006864</td>
    </tr>
    <tr>
      <th>17</th>
      <td>14.021824</td>
      <td>14.013749</td>
      <td>5.028994</td>
      <td>0.702405</td>
      <td>-0.526469</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.305000</td>
      <td>0.022280</td>
      <td>0.500000</td>
      <td>0.0</td>
      <td>0.029565</td>
      <td>0.000074</td>
      <td>0.002507</td>
      <td>0.002339</td>
      <td>0.008921</td>
      <td>0.050121</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.033596</td>
      <td>0.061382</td>
      <td>0.009223</td>
      <td>0.005383</td>
      <td>0.006864</td>
    </tr>
    <tr>
      <th>18</th>
      <td>14.021824</td>
      <td>14.013749</td>
      <td>5.028994</td>
      <td>0.702405</td>
      <td>-0.526469</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.305000</td>
      <td>0.022280</td>
      <td>0.500000</td>
      <td>0.0</td>
      <td>0.029565</td>
      <td>0.000074</td>
      <td>0.002507</td>
      <td>0.002339</td>
      <td>0.008921</td>
      <td>0.050121</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.033596</td>
      <td>0.061382</td>
      <td>0.009223</td>
      <td>0.005383</td>
      <td>0.006864</td>
    </tr>
    <tr>
      <th>19</th>
      <td>14.022732</td>
      <td>14.014400</td>
      <td>5.029001</td>
      <td>0.702364</td>
      <td>-0.526447</td>
      <td>1</td>
      <td>0.0048</td>
      <td>0.0565</td>
      <td>0.304985</td>
      <td>0.022280</td>
      <td>0.500000</td>
      <td>0.0</td>
      <td>0.029565</td>
      <td>0.000074</td>
      <td>0.002507</td>
      <td>0.002339</td>
      <td>0.008921</td>
      <td>0.050121</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.033595</td>
      <td>0.061381</td>
      <td>0.009223</td>
      <td>0.005383</td>
      <td>0.006864</td>
    </tr>
  </tbody>
</table>
</div><p>The fit yields a point with <span class="math notranslate nohighlight">\(\chi^2\)</span> arround 5. Since
<span class="math notranslate nohighlight">\(\chi^2=x\)</span> can be interpreted as the specific point lying in the
<span class="math notranslate nohighlight">\(\sqrt{x}\,\sigma\)</span> confidence level region, this means that our
point is outside the 2<span class="math notranslate nohighlight">\(\sigma\)</span> but inside the 3<span class="math notranslate nohighlight">\(\sigma\)</span>
region of the experimental data. Let us take a look at the individual
contributions to <span class="math notranslate nohighlight">\(\chi^2\)</span> for the best-fit point by</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MyModel</span><span class="o">.</span><span class="n">print_chisq</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;me/mu&#39;</span><span class="p">:</span> <span class="mf">0.0048</span><span class="p">,</span>   <span class="n">chisq</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="s1">&#39;mu/mt&#39;</span><span class="p">:</span> <span class="mf">0.0565</span><span class="p">,</span>   <span class="n">chisq</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="s1">&#39;s12^2&#39;</span><span class="p">:</span> <span class="mf">0.30500000121100895</span><span class="p">,</span>   <span class="n">chisq</span><span class="p">:</span> <span class="mf">4.2032172992145e-08</span>
<span class="s1">&#39;s13^2&#39;</span><span class="p">:</span> <span class="mf">0.02219999995440627</span><span class="p">,</span>   <span class="n">chisq</span><span class="p">:</span> <span class="mf">1.0523577958707064e-08</span>
<span class="s1">&#39;s23^2&#39;</span><span class="p">:</span> <span class="mf">0.4999568484745416</span><span class="p">,</span>   <span class="n">chisq</span><span class="p">:</span> <span class="mf">2.9383389552791437</span>
<span class="s1">&#39;d/pi&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>   <span class="n">chisq</span><span class="p">:</span> <span class="mf">2.71318</span>
<span class="s1">&#39;m21^2&#39;</span><span class="p">:</span> <span class="mf">7.414848837981547e-05</span><span class="p">,</span>   <span class="n">chisq</span><span class="p">:</span> <span class="mf">0.0003285239267222246</span>
<span class="s1">&#39;m3l^2&#39;</span><span class="p">:</span> <span class="mf">0.0025053616533515753</span><span class="p">,</span>   <span class="n">chisq</span><span class="p">:</span> <span class="mf">0.00010020584059472139</span>
<span class="n">Total</span> <span class="n">chi</span><span class="o">-</span><span class="n">square</span><span class="p">:</span> <span class="mf">5.651947737602212</span>
</pre></div>
</div>
<p>It looks like the <span class="math notranslate nohighlight">\(\sin^2\theta_{12}\)</span>, <span class="math notranslate nohighlight">\(\sin^2\theta_{13}\)</span>,
<span class="math notranslate nohighlight">\(\Delta m_{21}^2\)</span>, and <span class="math notranslate nohighlight">\(\Delta m_{3\ell}^2\)</span> are within their
experimental 1<span class="math notranslate nohighlight">\(\sigma\)</span> intervall. However,
<span class="math notranslate nohighlight">\(\sin^2\theta_{23}\)</span> and the CP phase
<span class="math notranslate nohighlight">\(\delta_{\mathrm{CP}}/\pi\)</span> are only within their experimental
2<span class="math notranslate nohighlight">\(\sigma\)</span> intervall. On a side note, it is no surprise, that the
CP phase is off, since it is always CP conserving due to the mass
matrices being real. All errors then add up to our best-fit point of the
model lying within the 3<span class="math notranslate nohighlight">\(\sigma\)</span> confidence level region.</p>
</section>
<section id="mcmc-fit-to-explore-the-minimum-of-the-model">
<h2>MCMC fit to explore the minimum of the model<a class="headerlink" href="#mcmc-fit-to-explore-the-minimum-of-the-model" title="Permalink to this heading">#</a></h2>
<p>To explore the neighborhood of the minimum we use the emcee marcov chain
monte carlo sampler.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_mcmc</span> <span class="o">=</span> <span class="n">MyModel</span><span class="o">.</span><span class="n">mcmc_fit</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">mcmc_steps</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">df_mcmc</span> <span class="o">=</span> <span class="n">MyModel</span><span class="o">.</span><span class="n">complete_fit</span><span class="p">(</span><span class="n">df_mcmc</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span>0 : 100%|██████████| 2000/2000 [00:30&lt;00:00, 65.16it/s]
</pre></div>
</div>
</section>
<section id="plotting-the-results">
<h2>Plotting the results<a class="headerlink" href="#plotting-the-results" title="Permalink to this heading">#</a></h2>
<p>We can plot the parameterspace and see the contour of the
3<span class="math notranslate nohighlight">\(\sigma\)</span> CL region. The colormap is scaled in such a way that
the 1<span class="math notranslate nohighlight">\(\sigma\)</span> region, i.e. <span class="math notranslate nohighlight">\(\chi^2&lt;1\)</span>, is green, the
2<span class="math notranslate nohighlight">\(\sigma\)</span> region with <span class="math notranslate nohighlight">\(1&lt;\chi^2&lt;4\)</span> is yellow, the
3<span class="math notranslate nohighlight">\(\sigma\)</span> region with <span class="math notranslate nohighlight">\(4&lt;\chi^2&lt;9\)</span> is orange, and anything
white lies outside of the <span class="math notranslate nohighlight">\(5\sigma\)</span> region.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_mcmc</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">25</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../_images/simpleexample_modelfitting_v1_v2.png" src="../_images/simpleexample_modelfitting_v1_v2.png" />
<p>We can also plot the observables and their corresponding
1<span class="math notranslate nohighlight">\(\sigma\)</span> and 3<span class="math notranslate nohighlight">\(\sigma\)</span> CL bounds from NuFit v5.3,
i.e. <a class="reference external" href="http://www.nu-fit.org/?q=node/278">http://www.nu-fit.org/?q=node/278</a>,</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_mcmc</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;s12^2&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;m21^2&#39;</span><span class="p">,</span> <span class="n">show_exp</span><span class="o">=</span><span class="s1">&#39;1dim&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">25</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../_images/simpleexample_modelfitting_s12_m21.png" src="../_images/simpleexample_modelfitting_s12_m21.png" />
<p>but also the two dimensional <span class="math notranslate nohighlight">\(\chi^2\)</span>-profiles to get a better
estimate of the CL regions for correlated, non-gaussian errors, e.g.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_mcmc</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;s23^2&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;d/pi&#39;</span><span class="p">,</span> <span class="n">show_exp</span><span class="o">=</span><span class="s1">&#39;2dim&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">gridsize</span><span class="o">=</span><span class="mi">8</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../_images/simpleexample_modelfitting_s23_dpi.png" src="../_images/simpleexample_modelfitting_s23_dpi.png" />
<p>Note that our model spreads out the full 1<span class="math notranslate nohighlight">\(\sigma\)</span> region of the
well measured <span class="math notranslate nohighlight">\(\sin^2\theta_{12}\)</span> and <span class="math notranslate nohighlight">\(\sin^2\theta_{13}\)</span>
while having a clear prediction for <span class="math notranslate nohighlight">\(\sin^2\theta_{23}\)</span> and the
CP-angle <span class="math notranslate nohighlight">\(\delta_{\mathrm{CP}}^\ell/\pi\)</span>, which have not yet been
measured that precisely.</p>
<p>Also from the lobster plot we see a prediction for the lightest neutrino
mass and the effective neutrion mass for neutrinoless double beta decay:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_mcmc</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;m1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;m_bb&#39;</span><span class="p">,</span>
             <span class="n">ordering</span><span class="o">=</span><span class="s1">&#39;NO&#39;</span><span class="p">,</span> <span class="n">show_exp</span><span class="o">=</span><span class="s1">&#39;2dim&#39;</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="mf">0.037</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.21</span><span class="p">);</span> <span class="c1"># arXiv: 2009.03287</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhspan</span><span class="p">(</span><span class="mf">0.156</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.21</span><span class="p">);</span>  <span class="c1"># arXiv: 2203.02139</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhspan</span><span class="p">(</span><span class="mf">0.036</span><span class="p">,</span><span class="mf">0.156</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.13</span><span class="p">);</span>  <span class="c1"># arXiv: 2203.02139</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.0012</span><span class="p">,</span><span class="s1">&#39;Cosmology&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.0006</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="s1">&#39;KamLAND-Zen&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../_images/simpleexample_modelfitting_lobster.png" src="../_images/simpleexample_modelfitting_lobster.png" />
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-flavorpy">Import FlavorPy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-mass-matrices">Defining mass matrices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-parameterspace">Defining parameterspace</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constructing-model">Constructing Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-model-to-experimental-data">Fitting model to experimental data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mcmc-fit-to-explore-the-minimum-of-the-model">MCMC fit to explore the minimum of the model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-results">Plotting the results</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../_sources/examples/simpleexample_modelfitting.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner"></div>
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2024, Alexander Baur.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://sphinx-doc.org/">Sphinx</a> 6.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>