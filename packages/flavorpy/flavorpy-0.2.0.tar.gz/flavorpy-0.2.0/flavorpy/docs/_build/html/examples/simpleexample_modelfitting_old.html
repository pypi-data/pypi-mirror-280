

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Simple example &#8212; FlavorPy 0.2.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/simpleexample_modelfitting_old';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">FlavorPy 0.2.0 documentation</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../constructterms.html">
                        ConstructTerms
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../modelfitting.html">
                        ModelFitting
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="examples_page.html">
                        Examples
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/flavorpy/flavorpy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../constructterms.html">
                        ConstructTerms
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../modelfitting.html">
                        ModelFitting
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="examples_page.html">
                        Examples
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/flavorpy/flavorpy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Simple example</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="simple-example">
<h1>Simple example<a class="headerlink" href="#simple-example" title="Permalink to this heading">#</a></h1>
<p>This example is supposed to serve as a quick start to the ModelFitting module of FlavorPy.</p>
<section id="import-flavorpy">
<h2>Import FlavorPy<a class="headerlink" href="#import-flavorpy" title="Permalink to this heading">#</a></h2>
<p>After installing FlavorPy with
<code class="code docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">flavorpy</span></code>,
import the modelfitting module.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the modelfitting module of FlavorPy</span>
<span class="kn">import</span> <span class="nn">flavorpy.modelfitting</span> <span class="k">as</span> <span class="nn">mf</span>

<span class="c1"># We will also need numpy and pandas</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</section>
<section id="defining-mass-matrices">
<h2>Defining mass matrices<a class="headerlink" href="#defining-mass-matrices" title="Permalink to this heading">#</a></h2>
<p>To define a model of leptons, we start by defining its mass matrices</p>
<p><span class="math notranslate nohighlight">\(m_e = \begin{pmatrix}v_1 &amp; v_2 &amp; v_3 \\ v_3 &amp; v_1 &amp; v_2 \\ v_2 &amp; v_3 &amp; v_1\end{pmatrix} \quad\)</span>
and
<span class="math notranslate nohighlight">\(\quad m_n = \begin{pmatrix}v_1 &amp; v_2 &amp; v_3 \\ v_2 &amp; v_1 &amp; 2 \\ v_3 &amp; 2 &amp; v_1\end{pmatrix}\)</span></p>
<p>For this example we have:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Charged lepton mass matrix</span>
<span class="k">def</span> <span class="nf">Me</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="p">,</span><span class="n">v3</span><span class="p">],</span> <span class="p">[</span><span class="n">v3</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">],</span> <span class="p">[</span><span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">,</span> <span class="n">v1</span><span class="p">]])</span>

<span class="c1"># Neutrino mass matrix</span>
<span class="k">def</span> <span class="nf">Mn</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;v3&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">],</span> <span class="p">[</span><span class="n">v2</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">v3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">v1</span><span class="p">]])</span>
</pre></div>
</div>
</section>
<section id="defining-parameterspace">
<h2>Defining parameterspace<a class="headerlink" href="#defining-parameterspace" title="Permalink to this heading">#</a></h2>
<p>Next, we define the parameterspace of our model. We therefore construct
an empty parameter space and add the parameters to it. When drawing
random points in our parameter space, we will evaluate the ‘sample_fct’,
which in this case is numpys uniform distribution between 0 and 1.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ParamSpace</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">ParameterSpace</span><span class="p">()</span>
<span class="n">ParamSpace</span><span class="o">.</span><span class="n">add_dim</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span> <span class="n">sample_fct</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">)</span>
<span class="n">ParamSpace</span><span class="o">.</span><span class="n">add_dim</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="n">sample_fct</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">)</span>
<span class="n">ParamSpace</span><span class="o">.</span><span class="n">add_dim</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;v3&#39;</span><span class="p">,</span> <span class="n">sample_fct</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="constructing-model">
<h2>Constructing Model<a class="headerlink" href="#constructing-model" title="Permalink to this heading">#</a></h2>
<p>Then we can construct the lepton model as follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Model0</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">LeptonModel</span><span class="p">(</span><span class="n">mass_matrix_e</span><span class="o">=</span><span class="n">Me</span><span class="p">,</span> <span class="n">mass_matrix_n</span><span class="o">=</span><span class="n">Mn</span><span class="p">,</span> <span class="n">parameterspace</span><span class="o">=</span><span class="n">ParamSpace</span><span class="p">,</span> <span class="n">ordering</span><span class="o">=</span><span class="s1">&#39;NO&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can determine the masses and mixing observables of a given point
in parameter space by:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Model0</span><span class="o">.</span><span class="n">get_obs</span><span class="p">({</span><span class="s1">&#39;v1&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;v2&#39;</span><span class="p">:</span> <span class="mf">1.1</span><span class="p">,</span> <span class="s1">&#39;v3&#39;</span><span class="p">:</span> <span class="mf">1.3</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;me/mu&#39;</span><span class="p">:</span> <span class="mf">0.9999999999999992</span><span class="p">,</span>
 <span class="s1">&#39;mu/mt&#39;</span><span class="p">:</span> <span class="mf">0.08882311833686546</span><span class="p">,</span>
 <span class="s1">&#39;s12^2&#39;</span><span class="p">:</span> <span class="mf">0.6420066494741999</span><span class="p">,</span>
 <span class="s1">&#39;s13^2&#39;</span><span class="p">:</span> <span class="mf">0.008093453559868121</span><span class="p">,</span>
 <span class="s1">&#39;s23^2&#39;</span><span class="p">:</span> <span class="mf">0.0012798653500391485</span><span class="p">,</span>
 <span class="s1">&#39;d/pi&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="mf">0.001571483801833027</span><span class="p">,</span>
 <span class="s1">&#39;m21^2&#39;</span><span class="p">:</span> <span class="mf">3.90198549455977e-05</span><span class="p">,</span>
 <span class="s1">&#39;m3l^2&#39;</span><span class="p">:</span> <span class="mf">0.024829944094927194</span><span class="p">,</span>
 <span class="s1">&#39;m1&#39;</span><span class="p">:</span> <span class="mf">0.018287792823374217</span><span class="p">,</span>
 <span class="s1">&#39;m2&#39;</span><span class="p">:</span> <span class="mf">0.019325196539654005</span><span class="p">,</span>
 <span class="s1">&#39;m3&#39;</span><span class="p">:</span> <span class="mf">0.15863287005308152</span><span class="p">,</span>
 <span class="s1">&#39;eta1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
 <span class="s1">&#39;eta2&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s1">&#39;J&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
 <span class="s1">&#39;Jmax&#39;</span><span class="p">:</span> <span class="mf">0.0015294982440766927</span><span class="p">,</span>
 <span class="s1">&#39;Sum(m_i)&#39;</span><span class="p">:</span> <span class="mf">0.19624585941610972</span><span class="p">,</span>
 <span class="s1">&#39;m_b&#39;</span><span class="p">:</span> <span class="mf">0.02367630520881936</span><span class="p">,</span>
 <span class="s1">&#39;m_bb&#39;</span><span class="p">:</span> <span class="mf">0.020085293881200113</span><span class="p">,</span>
 <span class="s1">&#39;nscale&#39;</span><span class="p">:</span> <span class="mf">0.03548228305985807</span><span class="p">}</span>
</pre></div>
</div>
<p>Here, ‘me/mu’ is the mass ratio of electron mass divided by muon mass,
‘sij^2’ refers to the mixing angles <span class="math notranslate nohighlight">\(\sin^2(\theta_{ij})\)</span>, ‘d/pi’
is the cp violating phase in the PMNS matrix divided by <span class="math notranslate nohighlight">\(\pi\)</span>,
‘m21^2’ and ‘m3l^2’ and the squared neutrino mass differences, i.e.
mij^2 = m_i^2 - m_j^2, ‘r’ is their quotient r = m21^2 / m3l^2, ‘m1’
and ‘m2’ and ‘m3’ are the neutrino masses, ‘eta1’ and ‘eta2’ are the
majorana phases, ‘J’ is the Jarskog determinant, ‘m_b’ and ‘m_bb’ are
the effective neutrino masses for beta decay and neutrinoless double
beta decay, respectively.</p>
</section>
<section id="fitting-model-to-experimental-data">
<h2>Fitting model to experimental data<a class="headerlink" href="#fitting-model-to-experimental-data" title="Permalink to this heading">#</a></h2>
<p>Let us now fit this model to a specific experimental data set. As a
default the NuFit v5.2 for NO with SK data is used. To fit this model we
choose for example 3 randomly drawn points in the parameter space and
apply minimization algorithms to these points, in order to find a point
that matches the experimental data well. Note that by default 4
minimization algorithms are applied consecutively to all 3 random points
such that we get 12 points in the end.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># This pandas setting allows us to see all columns</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">Model0</span><span class="o">.</span><span class="n">make_fit</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th></th>
      <th style="min-width: 120px;">chisq</th>
      <th style="min-width: 120px;">chisq_dimless</th>
      <th style="min-width: 90px;">v1</th>
      <th style="min-width: 90px;">v2</th>
      <th style="min-width: 90px;">v3</th>
      <th>n_scale</th>
      <th style="min-width: 90px;">me/mu</th>
      <th style="min-width: 90px;">mu/mt</th>
      <th style="min-width: 90px;">s12^2</th>
      <th style="min-width: 90px;">s13^2</th>
      <th style="min-width: 90px;">s23^2</th>
      <th style="min-width: 50px;">d/pi</th>
      <th style="min-width: 90px;">r</th>
      <th style="min-width: 90px;">m21^2</th>
      <th style="min-width: 90px;">m3l^2</th>
      <th style="min-width: 90px;">m1</th>
      <th style="min-width: 90px;">m2</th>
      <th style="min-width: 90px;">m3</th>
      <th>eta1</th>
      <th>eta2</th>
      <th style="min-width: 120px;">J</th>
      <th style="min-width: 90px;">Jmax</th>
      <th style="min-width: 90px;">Sum(m_i)</th>
      <th style="min-width: 90px;">m_b</th>
      <th style="min-width: 90px;">m_bb</th>
      <th style="min-width: 90px;">nscale</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4.734807e+04</td>
      <td>4.734231e+04</td>
      <td>-1.058010</td>
      <td>1.041775</td>
      <td>0.007423</td>
      <td>1.0</td>
      <td>0.004846</td>
      <td>1.000000</td>
      <td>0.939127</td>
      <td>0.020008</td>
      <td>0.043020</td>
      <td>0.0</td>
      <td>0.031346</td>
      <td>0.000076</td>
      <td>0.002435</td>
      <td>0.016754</td>
      <td>0.018896</td>
      <td>0.052117</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.006725</td>
      <td>0.087767</td>
      <td>0.020031</td>
      <td>0.019447</td>
      <td>0.015745</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.734955e+04</td>
      <td>4.734214e+04</td>
      <td>-1.057276</td>
      <td>1.041025</td>
      <td>0.007412</td>
      <td>1.0</td>
      <td>0.004864</td>
      <td>1.000000</td>
      <td>0.939013</td>
      <td>0.019994</td>
      <td>0.043101</td>
      <td>0.0</td>
      <td>0.031618</td>
      <td>0.000077</td>
      <td>0.002425</td>
      <td>0.016712</td>
      <td>0.018867</td>
      <td>0.052006</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.006734</td>
      <td>0.087585</td>
      <td>0.019997</td>
      <td>0.019416</td>
      <td>0.015717</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.763479e+04</td>
      <td>4.762738e+04</td>
      <td>-1.057276</td>
      <td>1.041023</td>
      <td>0.007410</td>
      <td>1.0</td>
      <td>0.004866</td>
      <td>1.000000</td>
      <td>0.939013</td>
      <td>0.019994</td>
      <td>0.956899</td>
      <td>1.0</td>
      <td>0.031618</td>
      <td>0.000077</td>
      <td>0.002425</td>
      <td>0.016712</td>
      <td>0.018867</td>
      <td>0.052006</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>8.247443e-19</td>
      <td>0.006735</td>
      <td>0.087585</td>
      <td>0.019997</td>
      <td>0.019416</td>
      <td>0.015717</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.455653e+07</td>
      <td>1.508985e+07</td>
      <td>-0.060572</td>
      <td>0.757247</td>
      <td>-0.067181</td>
      <td>1.0</td>
      <td>0.766606</td>
      <td>1.000000</td>
      <td>0.875886</td>
      <td>0.016517</td>
      <td>0.471467</td>
      <td>1.0</td>
      <td>0.856485</td>
      <td>0.001111</td>
      <td>0.001297</td>
      <td>0.000261</td>
      <td>0.033327</td>
      <td>0.036011</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.547627e-18</td>
      <td>0.020803</td>
      <td>0.069600</td>
      <td>0.031568</td>
      <td>0.029551</td>
      <td>0.016206</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.476148e+07</td>
      <td>2.476143e+07</td>
      <td>1.116427</td>
      <td>0.933827</td>
      <td>0.761301</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>0.109402</td>
      <td>0.308190</td>
      <td>0.025502</td>
      <td>0.005890</td>
      <td>1.0</td>
      <td>0.036244</td>
      <td>0.000082</td>
      <td>0.002276</td>
      <td>0.007401</td>
      <td>0.011716</td>
      <td>0.048275</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>6.733970e-19</td>
      <td>0.005499</td>
      <td>0.067392</td>
      <td>0.011819</td>
      <td>0.009761</td>
      <td>0.013125</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.476176e+07</td>
      <td>2.476165e+07</td>
      <td>1.081985</td>
      <td>0.903959</td>
      <td>0.711235</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>0.119073</td>
      <td>0.352498</td>
      <td>0.027924</td>
      <td>0.007796</td>
      <td>1.0</td>
      <td>0.042208</td>
      <td>0.000090</td>
      <td>0.002131</td>
      <td>0.007458</td>
      <td>0.012066</td>
      <td>0.046764</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>8.358433e-19</td>
      <td>0.006825</td>
      <td>0.066289</td>
      <td>0.012185</td>
      <td>0.010161</td>
      <td>0.012988</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2.476205e+07</td>
      <td>2.476193e+07</td>
      <td>1.070584</td>
      <td>0.917638</td>
      <td>0.644437</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>0.142031</td>
      <td>0.521885</td>
      <td>0.026420</td>
      <td>0.012484</td>
      <td>1.0</td>
      <td>0.044094</td>
      <td>0.000092</td>
      <td>0.002094</td>
      <td>0.007832</td>
      <td>0.012396</td>
      <td>0.046423</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.074881e-18</td>
      <td>0.008777</td>
      <td>0.066652</td>
      <td>0.012884</td>
      <td>0.011197</td>
      <td>0.013033</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2.476215e+07</td>
      <td>2.476202e+07</td>
      <td>1.065823</td>
      <td>0.917655</td>
      <td>0.625517</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>0.148736</td>
      <td>0.554173</td>
      <td>0.026439</td>
      <td>0.013648</td>
      <td>1.0</td>
      <td>0.044925</td>
      <td>0.000093</td>
      <td>0.002078</td>
      <td>0.007942</td>
      <td>0.012508</td>
      <td>0.046274</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.118010e-18</td>
      <td>0.009129</td>
      <td>0.066724</td>
      <td>0.013071</td>
      <td>0.011445</td>
      <td>0.013044</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2.477452e+07</td>
      <td>2.477439e+07</td>
      <td>2.665004</td>
      <td>-0.107629</td>
      <td>4.486246</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>0.568848</td>
      <td>0.627061</td>
      <td>0.025983</td>
      <td>0.085722</td>
      <td>0.0</td>
      <td>0.044634</td>
      <td>0.000093</td>
      <td>0.002084</td>
      <td>0.014539</td>
      <td>0.017446</td>
      <td>0.047906</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.000000e+00</td>
      <td>0.021255</td>
      <td>0.079891</td>
      <td>0.018020</td>
      <td>0.017207</td>
      <td>0.006356</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2.477452e+07</td>
      <td>2.477439e+07</td>
      <td>2.665004</td>
      <td>-0.107629</td>
      <td>4.486246</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>0.568848</td>
      <td>0.627061</td>
      <td>0.025983</td>
      <td>0.085722</td>
      <td>0.0</td>
      <td>0.044634</td>
      <td>0.000093</td>
      <td>0.002084</td>
      <td>0.014539</td>
      <td>0.017446</td>
      <td>0.047906</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.000000e+00</td>
      <td>0.021255</td>
      <td>0.079891</td>
      <td>0.018020</td>
      <td>0.017207</td>
      <td>0.006356</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2.477857e+07</td>
      <td>2.499999e+07</td>
      <td>0.283663</td>
      <td>0.041842</td>
      <td>0.679834</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>0.554919</td>
      <td>0.884184</td>
      <td>0.000612</td>
      <td>0.133847</td>
      <td>1.0</td>
      <td>0.563388</td>
      <td>0.000743</td>
      <td>0.001319</td>
      <td>0.003915</td>
      <td>0.027542</td>
      <td>0.036532</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.299055e-19</td>
      <td>0.002694</td>
      <td>0.067989</td>
      <td>0.025949</td>
      <td>0.024819</td>
      <td>0.015164</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2.477902e+07</td>
      <td>2.478546e+07</td>
      <td>2.169190</td>
      <td>-0.118765</td>
      <td>5.225849</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>0.638308</td>
      <td>0.605378</td>
      <td>0.015513</td>
      <td>0.119236</td>
      <td>1.0</td>
      <td>0.127448</td>
      <td>0.000197</td>
      <td>0.001544</td>
      <td>0.011954</td>
      <td>0.018431</td>
      <td>0.041074</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.378544e-18</td>
      <td>0.019422</td>
      <td>0.071459</td>
      <td>0.016947</td>
      <td>0.016302</td>
      <td>0.005316</td>
    </tr>
  </tbody>
</table>
</div><p>Well, from the high value of <span class="math notranslate nohighlight">\(\chi^2\)</span>, we see that this model
doesn’t seem to be able to replicate the experimentally measured values.
Let us take a look at the individual contributions to <span class="math notranslate nohighlight">\(\chi^2\)</span> for
the first point by</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Model0</span><span class="o">.</span><span class="n">print_chisq</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;me/mu&#39;</span><span class="p">:</span> <span class="mf">0.0048458380255911905</span><span class="p">,</span>   <span class="n">chisq</span><span class="p">:</span> <span class="mf">0.05252811475246681</span>
<span class="s1">&#39;mu/mt&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>   <span class="n">chisq</span><span class="p">:</span> <span class="mf">43960.11111111111</span>
<span class="s1">&#39;s12^2&#39;</span><span class="p">:</span> <span class="mf">0.9391272761692583</span><span class="p">,</span>   <span class="n">chisq</span><span class="p">:</span> <span class="mf">2810.124385323049</span>
<span class="s1">&#39;s13^2&#39;</span><span class="p">:</span> <span class="mf">0.020008064149810444</span><span class="p">,</span>   <span class="n">chisq</span><span class="p">:</span> <span class="mf">15.032334445663338</span>
<span class="s1">&#39;s23^2&#39;</span><span class="p">:</span> <span class="mf">0.04301966448870213</span><span class="p">,</span>   <span class="n">chisq</span><span class="p">:</span> <span class="mf">543.503523800527</span>
<span class="s1">&#39;d/pi&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>   <span class="n">chisq</span><span class="p">:</span> <span class="mf">10.98525</span>
<span class="s1">&#39;m21^2&#39;</span><span class="p">:</span> <span class="mf">7.634175414433096e-05</span><span class="p">,</span>   <span class="n">chisq</span><span class="p">:</span> <span class="mf">1.115587066597515</span>
<span class="s1">&#39;m3l^2&#39;</span><span class="p">:</span> <span class="mf">0.002435482734326478</span><span class="p">,</span>   <span class="n">chisq</span><span class="p">:</span> <span class="mf">7.142800422396115</span>
<span class="n">Total</span> <span class="n">chi</span><span class="o">-</span><span class="n">square</span><span class="p">:</span> <span class="mf">47348.067520284094</span>
</pre></div>
</div>
<p>It looks like several observables are not in agreement with the
experimental data. Note that <span class="math notranslate nohighlight">\(\chi^2=x\)</span> is often interpreted as the
specific point lying in the <span class="math notranslate nohighlight">\(\sqrt{x}\,\sigma\)</span> confidence level
region.</p>
<p>All in all, the model was probably to simple or we needed to widen the
boundaries of our parameter space.</p>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-flavorpy">Import FlavorPy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-mass-matrices">Defining mass matrices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-parameterspace">Defining parameterspace</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constructing-model">Constructing Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-model-to-experimental-data">Fitting model to experimental data</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../_sources/examples/simpleexample_modelfitting_old.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner"></div>
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2024, Alexander Baur.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://sphinx-doc.org/">Sphinx</a> 6.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>