import{_ as O,b2 as L,$ as c,aH as d,aQ as l,aJ as b,T as u,a0 as S,V as _,aI as y,am as P,bA as j,W as T,E as w,D as C,cn as K,co as B,l as g,X as v,aL as E,Z as k,al as R}from"./admin-drawer-panel-c3f3H29x.js";import{V as D}from"./VTable-CkCZonsu.js";import{C as V}from"./confirm-dialog-BrzuoYAT.js";import{c as N}from"./copy-to-clipboard-DoUvDJVx.js";import{C as p}from"./main-B3MfqYNN.js";import"./VDialog-BB4zqrGw.js";const x={name:"StatsTable",props:{title:{type:String,required:!0},items:{type:Object,required:!0}},data(){return{}},methods:{valueTable(e){return typeof e=="object"?e:{}},tdClasses(e){return{indent:e[0]==="+"}},tdLabel(e){return e.replace(/^\+/,"")},nf(e){return typeof e=="number"?L.format(e):e}}},U={class:"statBlock"},G={key:0},$={colspan:"2",class:"subtitleRow"},z={key:1},F={class:"indent"};function H(e,s,t,r,o,a){return c(),d("div",U,[l("h3",null,b(t.title),1),u(D,{class:"highlight-table"},{default:S(()=>[(c(!0),d(_,null,y(Object.entries(t.items),([n,i])=>(c(),d("tbody",{key:n},[typeof i=="object"?(c(),d("tr",G,[l("th",$,b(n),1)])):(c(),d("tr",z,[l("td",{class:P(a.tdClasses(n))},b(a.tdLabel(n)),3),l("td",null,b(a.nf(i)),1)])),(c(!0),d(_,null,y(Object.entries(a.valueTable(i)),([f,m])=>(c(),d("tr",{key:f},[l("td",F,b(f),1),l("td",null,b(a.nf(m)),1)]))),128))]))),128)),j(e.$slots,"default",{},void 0,!0)]),_:3})])}const M=O(x,[["render",H],["__scopeId","data-v-dc911a2e"]]),q="Copy API Key to clipboard",h=e=>{const s={};for(const t of e)s[t.value]=t.title;return s},A={topGroup:p.browser.groupNames,orderBy:h(p.browser.orderBy),fitTo:h(p.reader.fitTo),readingDirection:h(p.reader.readingDirection)};Object.freeze(A);const I=new Set(["storyArcNumbersCount","identifierTypesCount","contributorPersonsCount","contributorRolesCount"]);Object.freeze(I);const X={name:"AdminTasksTab",components:{ConfirmDialog:V,StatsTable:M},data(){return{showTooltip:{show:!1},apiSchemaURL:window.CODEX.API_V3_PATH}},computed:{...T(w,{}),...T(C,{stats:e=>e.stats}),clipBoardEnabled(){return location.prototcal=="https:"},apiTooltip(){return q?this.clipBoardEnabled:void 0},clipBoardIcon(){return this.showTooltip?K:B},platformTable(){var s;const e={};for(const[t,r]of Object.entries((s=this.stats)==null?void 0:s.platform)){let o=r;if(t==="system")o+=" "+this.stats.platform.systemRelease;else if(t==="systemRelease")continue;const a=this.keyToLabel(t);e[a]=o}return e},configTable(){var t;const e={};let s="";for(const[r,o]of Object.entries((t=this.stats)==null?void 0:t.config)){let a;if(r=="apiKey"){s=o;continue}else a=this.keyToLabel(r);e[a]=o}return e["API Key"]=s,e},userSettingsTable(){var s;const e={};for(const[t,r]of Object.entries((s=this.stats)==null?void 0:s.sessions)){const o={},a=A[t];for(const[i,f]of Object.entries(r)){let m;a?m=a[g.snakeCase(i)]:m=i,o[m]=f}const n=this.keyToLabel(t);e[n]=o}return e},browserGroupsTable(){var s;const e={};for(const[t,r]of Object.entries((s=this.stats)==null?void 0:s.groups)){const o=this.keyToLabel(t);e[o]=r}return e},fileTypesTable(){var s;const e={};for(const[t,r]of Object.entries((s=this.stats)==null?void 0:s.fileTypes)){const o=this.keyToLabel(t).toUpperCase();e[o]=r}return e},metadataTable(){var s;const e={};for(const[t,r]of Object.entries((s=this.stats)==null?void 0:s.metadata)){let o=this.keyToLabel(t);I.has(t)&&(o=o.replace(/^\w+ /,"+")),e[o]=r}return e}},created(){this.loadStats()},methods:{...v(C,["loadStats","updateAPIKey"]),regenAPIKey(){this.updateAPIKey().then(this.loadStats).catch(console.warn)},onClickAPIKey(){this.clipBoardEnabled&&N(this.stats.config.apiKey,this.showTooltip)},keyToLabel(e){return e=e.replace(/Count$/,""),g.startCase(e)}}},J={key:0,id:"stats"},Q={id:"schemaDoc"},W={colspan:"2"},Y=["href"],Z={colspan:"2"};function ee(e,s,t,r,o,a){const n=k("StatsTable"),i=k("ConfirmDialog");return e.stats?(c(),d("div",J,[u(n,{title:"Platform",items:a.platformTable},null,8,["items"]),u(n,{title:"Config",items:a.configTable},{default:S(()=>[l("tbody",null,[l("tr",Q,[l("td",W,[R(" The only endpoint accessible by API Key is "),l("a",{href:`${o.apiSchemaURL}#/api/api_v3_admin_stats_retrieve`,target:"_blank"},"/admin/stats",8,Y)])]),l("tr",null,[l("td",Z,[u(i,{"button-text":"Regenerate API Key","title-text":"Regenerate","object-name":"API Key","confirm-text":"Regenerate",onConfirm:a.regenAPIKey},null,8,["onConfirm"])])])])]),_:1},8,["items"]),u(n,{title:"User Settings",items:a.userSettingsTable},null,8,["items"]),u(n,{title:"Browser Groups",items:a.browserGroupsTable},null,8,["items"]),u(n,{title:"File Types",items:a.fileTypesTable},null,8,["items"]),u(n,{title:"Metadata",items:a.metadataTable},null,8,["items"])])):E("",!0)}const le=O(X,[["render",ee],["__scopeId","data-v-ac255546"]]);export{le as default};
