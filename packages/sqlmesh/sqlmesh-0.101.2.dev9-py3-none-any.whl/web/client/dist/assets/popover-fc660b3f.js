import{r as a,J as ee,v as X,D as A,y as W,aK as me,G as oe,aZ as le,aw as ce,x as g,a_ as ye,a$ as Se,b0 as Ee,w as ge,R as I,z as $e,A as G,B as q,X as j,I as K,b1 as de,ac as te,ad as ne,H as ve,at as H,W as N,b2 as Ie,K as he,T as Te,M as L,Q as fe,as as we,b3 as _,au as re}from"./index-45e2979d.js";function pe(e){var t;if(e.type)return e.type;let i=(t=e.as)!=null?t:"button";if(typeof i=="string"&&i.toLowerCase()==="button")return"button"}function xe(e,t){let[i,y]=a.useState(()=>pe(e));return ee(()=>{y(pe(e))},[e.type,e.as]),ee(()=>{i||t.current&&t.current instanceof HTMLButtonElement&&!t.current.hasAttribute("type")&&y("button")},[i,t]),i}var Ce=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Ce||{}),Me=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(Me||{});let Oe={0:e=>{let t={...e,popoverState:G(e.popoverState,{0:1,1:0})};return t.popoverState===0&&(t.__demoMode=!1),t},1(e){return e.popoverState===1?e:{...e,popoverState:1}},2(e,t){return e.button===t.button?e:{...e,button:t.button}},3(e,t){return e.buttonId===t.buttonId?e:{...e,buttonId:t.buttonId}},4(e,t){return e.panel===t.panel?e:{...e,panel:t.panel}},5(e,t){return e.panelId===t.panelId?e:{...e,panelId:t.panelId}}},ae=a.createContext(null);ae.displayName="PopoverContext";function Y(e){let t=a.useContext(ae);if(t===null){let i=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,Y),i}return t}let ue=a.createContext(null);ue.displayName="PopoverAPIContext";function se(e){let t=a.useContext(ue);if(t===null){let i=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,se),i}return t}let ie=a.createContext(null);ie.displayName="PopoverGroupContext";function be(){return a.useContext(ie)}let Z=a.createContext(null);Z.displayName="PopoverPanelContext";function ke(){return a.useContext(Z)}function Be(e,t){return G(t.type,Oe,e,t)}let Fe="div";function Re(e,t){var i;let{__demoMode:y=!1,...T}=e,l=a.useRef(null),n=W(t,me(s=>{l.current=s})),b=a.useRef([]),P=a.useReducer(Be,{__demoMode:y,popoverState:y?0:1,buttons:b,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:a.createRef(),afterPanelSentinel:a.createRef()}),[{popoverState:E,button:p,buttonId:$,panel:o,panelId:F,beforePanelSentinel:x,afterPanelSentinel:S},u]=P,m=oe((i=l.current)!=null?i:p),w=a.useMemo(()=>{if(!p||!o)return!1;for(let V of document.querySelectorAll("body > *"))if(Number(V==null?void 0:V.contains(p))^Number(V==null?void 0:V.contains(o)))return!0;let s=le(),C=s.indexOf(p),Q=(C+s.length-1)%s.length,z=(C+1)%s.length,U=s[Q],Pe=s[z];return!o.contains(U)&&!o.contains(Pe)},[p,o]),M=ce($),O=ce(F),R=a.useMemo(()=>({buttonId:M,panelId:O,close:()=>u({type:1})}),[M,O,u]),k=be(),c=k==null?void 0:k.registerPopover,h=g(()=>{var s;return(s=k==null?void 0:k.isFocusWithinPopoverGroup())!=null?s:(m==null?void 0:m.activeElement)&&((p==null?void 0:p.contains(m.activeElement))||(o==null?void 0:o.contains(m.activeElement)))});a.useEffect(()=>c==null?void 0:c(R),[c,R]);let[d,B]=ye(),r=Se({mainTreeNodeRef:k==null?void 0:k.mainTreeNodeRef,portals:d,defaultContainers:[p,o]});Ee(m==null?void 0:m.defaultView,"focus",s=>{var C,Q,z,U;s.target!==window&&s.target instanceof HTMLElement&&E===0&&(h()||p&&o&&(r.contains(s.target)||(Q=(C=x.current)==null?void 0:C.contains)!=null&&Q.call(C,s.target)||(U=(z=S.current)==null?void 0:z.contains)!=null&&U.call(z,s.target)||u({type:1})))},!0),ge(r.resolveContainers,(s,C)=>{u({type:1}),he(C,Te.Loose)||(s.preventDefault(),p==null||p.focus())},E===0);let v=g(s=>{u({type:1});let C=(()=>s?s instanceof HTMLElement?s:"current"in s&&s.current instanceof HTMLElement?s.current:p:p)();C==null||C.focus()}),f=a.useMemo(()=>({close:v,isPortalled:w}),[v,w]),D=a.useMemo(()=>({open:E===0,close:v}),[E,v]),J={ref:n};return I.createElement(Z.Provider,{value:null},I.createElement(ae.Provider,{value:P},I.createElement(ue.Provider,{value:f},I.createElement($e,{value:G(E,{0:q.Open,1:q.Closed})},I.createElement(B,null,j({ourProps:J,theirProps:T,slot:D,defaultTag:Fe,name:"Popover"}),I.createElement(r.MainTreeNode,null))))))}let De="button";function Ne(e,t){let i=K(),{id:y=`headlessui-popover-button-${i}`,...T}=e,[l,n]=Y("Popover.Button"),{isPortalled:b}=se("Popover.Button"),P=a.useRef(null),E=`headlessui-focus-sentinel-${K()}`,p=be(),$=p==null?void 0:p.closeOthers,o=ke()!==null;a.useEffect(()=>{if(!o)return n({type:3,buttonId:y}),()=>{n({type:3,buttonId:null})}},[o,y,n]);let[F]=a.useState(()=>Symbol()),x=W(P,t,o?null:r=>{if(r)l.buttons.current.push(F);else{let v=l.buttons.current.indexOf(F);v!==-1&&l.buttons.current.splice(v,1)}l.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),r&&n({type:2,button:r})}),S=W(P,t),u=oe(P),m=g(r=>{var v,f,D;if(o){if(l.popoverState===1)return;switch(r.key){case L.Space:case L.Enter:r.preventDefault(),(f=(v=r.target).click)==null||f.call(v),n({type:1}),(D=l.button)==null||D.focus();break}}else switch(r.key){case L.Space:case L.Enter:r.preventDefault(),r.stopPropagation(),l.popoverState===1&&($==null||$(l.buttonId)),n({type:0});break;case L.Escape:if(l.popoverState!==0)return $==null?void 0:$(l.buttonId);if(!P.current||u!=null&&u.activeElement&&!P.current.contains(u.activeElement))return;r.preventDefault(),r.stopPropagation(),n({type:1});break}}),w=g(r=>{o||r.key===L.Space&&r.preventDefault()}),M=g(r=>{var v,f;fe(r.currentTarget)||e.disabled||(o?(n({type:1}),(v=l.button)==null||v.focus()):(r.preventDefault(),r.stopPropagation(),l.popoverState===1&&($==null||$(l.buttonId)),n({type:0}),(f=l.button)==null||f.focus()))}),O=g(r=>{r.preventDefault(),r.stopPropagation()}),R=l.popoverState===0,k=a.useMemo(()=>({open:R}),[R]),c=xe(e,P),h=o?{ref:S,type:c,onKeyDown:m,onClick:M}:{ref:x,id:l.buttonId,type:c,"aria-expanded":l.popoverState===0,"aria-controls":l.panel?l.panelId:void 0,onKeyDown:m,onKeyUp:w,onClick:M,onMouseDown:O},d=de(),B=g(()=>{let r=l.panel;if(!r)return;function v(){G(d.current,{[_.Forwards]:()=>H(r,N.First),[_.Backwards]:()=>H(r,N.Last)})===re.Error&&H(le().filter(f=>f.dataset.headlessuiFocusGuard!=="true"),G(d.current,{[_.Forwards]:N.Next,[_.Backwards]:N.Previous}),{relativeTo:l.button})}v()});return I.createElement(I.Fragment,null,j({ourProps:h,theirProps:T,slot:k,defaultTag:De,name:"Popover.Button"}),R&&!o&&b&&I.createElement(te,{id:E,features:ne.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:B}))}let _e="div",Le=X.RenderStrategy|X.Static;function He(e,t){let i=K(),{id:y=`headlessui-popover-overlay-${i}`,...T}=e,[{popoverState:l},n]=Y("Popover.Overlay"),b=W(t),P=ve(),E=(()=>P!==null?(P&q.Open)===q.Open:l===0)(),p=g(o=>{if(fe(o.currentTarget))return o.preventDefault();n({type:1})}),$=a.useMemo(()=>({open:l===0}),[l]);return j({ourProps:{ref:b,id:y,"aria-hidden":!0,onClick:p},theirProps:T,slot:$,defaultTag:_e,features:Le,visible:E,name:"Popover.Overlay"})}let Ge="div",Ke=X.RenderStrategy|X.Static;function We(e,t){let i=K(),{id:y=`headlessui-popover-panel-${i}`,focus:T=!1,...l}=e,[n,b]=Y("Popover.Panel"),{close:P,isPortalled:E}=se("Popover.Panel"),p=`headlessui-focus-sentinel-before-${K()}`,$=`headlessui-focus-sentinel-after-${K()}`,o=a.useRef(null),F=W(o,t,c=>{b({type:4,panel:c})}),x=oe(o);ee(()=>(b({type:5,panelId:y}),()=>{b({type:5,panelId:null})}),[y,b]);let S=ve(),u=(()=>S!==null?(S&q.Open)===q.Open:n.popoverState===0)(),m=g(c=>{var h;switch(c.key){case L.Escape:if(n.popoverState!==0||!o.current||x!=null&&x.activeElement&&!o.current.contains(x.activeElement))return;c.preventDefault(),c.stopPropagation(),b({type:1}),(h=n.button)==null||h.focus();break}});a.useEffect(()=>{var c;e.static||n.popoverState===1&&((c=e.unmount)==null||c)&&b({type:4,panel:null})},[n.popoverState,e.unmount,e.static,b]),a.useEffect(()=>{if(n.__demoMode||!T||n.popoverState!==0||!o.current)return;let c=x==null?void 0:x.activeElement;o.current.contains(c)||H(o.current,N.First)},[n.__demoMode,T,o,n.popoverState]);let w=a.useMemo(()=>({open:n.popoverState===0,close:P}),[n,P]),M={ref:F,id:y,onKeyDown:m,onBlur:T&&n.popoverState===0?c=>{var h,d,B,r,v;let f=c.relatedTarget;f&&o.current&&((h=o.current)!=null&&h.contains(f)||(b({type:1}),((B=(d=n.beforePanelSentinel.current)==null?void 0:d.contains)!=null&&B.call(d,f)||(v=(r=n.afterPanelSentinel.current)==null?void 0:r.contains)!=null&&v.call(r,f))&&f.focus({preventScroll:!0})))}:void 0,tabIndex:-1},O=de(),R=g(()=>{let c=o.current;if(!c)return;function h(){G(O.current,{[_.Forwards]:()=>{var d;H(c,N.First)===re.Error&&((d=n.afterPanelSentinel.current)==null||d.focus())},[_.Backwards]:()=>{var d;(d=n.button)==null||d.focus({preventScroll:!0})}})}h()}),k=g(()=>{let c=o.current;if(!c)return;function h(){G(O.current,{[_.Forwards]:()=>{var d;if(!n.button)return;let B=le(),r=B.indexOf(n.button),v=B.slice(0,r+1),f=[...B.slice(r+1),...v];for(let D of f.slice())if(D.dataset.headlessuiFocusGuard==="true"||(d=n.panel)!=null&&d.contains(D)){let J=f.indexOf(D);J!==-1&&f.splice(J,1)}H(f,N.First,{sorted:!1})},[_.Backwards]:()=>{var d;H(c,N.Previous)===re.Error&&((d=n.button)==null||d.focus())}})}h()});return I.createElement(Z.Provider,{value:y},u&&E&&I.createElement(te,{id:p,ref:n.beforePanelSentinel,features:ne.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:R}),j({ourProps:M,theirProps:l,slot:w,defaultTag:Ge,features:Ke,visible:u,name:"Popover.Panel"}),u&&E&&I.createElement(te,{id:$,ref:n.afterPanelSentinel,features:ne.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:k}))}let qe="div";function ze(e,t){let i=a.useRef(null),y=W(i,t),[T,l]=a.useState([]),n=Ie(),b=g(S=>{l(u=>{let m=u.indexOf(S);if(m!==-1){let w=u.slice();return w.splice(m,1),w}return u})}),P=g(S=>(l(u=>[...u,S]),()=>b(S))),E=g(()=>{var S;let u=we(i);if(!u)return!1;let m=u.activeElement;return(S=i.current)!=null&&S.contains(m)?!0:T.some(w=>{var M,O;return((M=u.getElementById(w.buttonId.current))==null?void 0:M.contains(m))||((O=u.getElementById(w.panelId.current))==null?void 0:O.contains(m))})}),p=g(S=>{for(let u of T)u.buttonId.current!==S&&u.close()}),$=a.useMemo(()=>({registerPopover:P,unregisterPopover:b,isFocusWithinPopoverGroup:E,closeOthers:p,mainTreeNodeRef:n.mainTreeNodeRef}),[P,b,E,p,n.mainTreeNodeRef]),o=a.useMemo(()=>({}),[]),F=e,x={ref:y};return I.createElement(ie.Provider,{value:$},j({ourProps:x,theirProps:F,slot:o,defaultTag:qe,name:"Popover.Group"}),I.createElement(n.MainTreeNode,null))}let Ae=A(Re),je=A(Ne),Je=A(He),Qe=A(We),Ue=A(ze),Xe=Object.assign(Ae,{Button:je,Overlay:Je,Panel:Qe,Group:Ue});export{Xe as k,xe as s};
