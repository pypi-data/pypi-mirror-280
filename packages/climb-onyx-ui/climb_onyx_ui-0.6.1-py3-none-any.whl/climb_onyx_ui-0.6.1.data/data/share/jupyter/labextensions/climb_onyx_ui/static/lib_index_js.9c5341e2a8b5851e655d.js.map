{"version":3,"file":"lib_index_js.9c5341e2a8b5851e655d.js","mappings":"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","sources":["webpack://climb_onyx_ui/./src/App.tsx","webpack://climb_onyx_ui/./src/handler.ts","webpack://climb_onyx_ui/./src/icon.ts","webpack://climb_onyx_ui/./src/index.ts"],"sourcesContent":["import React from 'react';\r\nimport { ReactWidget } from '@jupyterlab/apputils';\r\n//import App from '../../react-prototype/src/App'\r\nimport Onyx from 'climb-onyx-gui';\r\n\r\nexport class ReactAppWidget extends ReactWidget {\r\n  constructor(\r\n    route: (route: string) => Promise<Response>,\r\n    s3: (path: string) => void,\r\n    fw: (path: string, content: string) => void,\r\n    v: string\r\n  ) {\r\n    super();\r\n    this.routeHandler = route;\r\n    this.s3PathHandler = s3;\r\n    this.fileWriter = fw;\r\n    this.version = v;\r\n  }\r\n\r\n  routeHandler: (route: string) => Promise<Response>;\r\n  s3PathHandler: (path: string) => void;\r\n  fileWriter: (path: string, content: string) => void;\r\n  version: string;\r\n\r\n  render(): JSX.Element {\r\n    return (\r\n      <Onyx\r\n        httpPathHandler={this.routeHandler}\r\n        s3PathHandler={this.s3PathHandler}\r\n        fileWriter={this.fileWriter}\r\n        extVersion={this.version}\r\n      />\r\n    );\r\n  }\r\n}\r\n","import { ServerConnection } from '@jupyterlab/services';\r\nimport { URLExt } from '@jupyterlab/coreutils';\r\n\r\n/**\r\n * Call the API extension\r\n *\r\n * @param endPoint API REST end point for the extension\r\n * @param init Initial values for the request\r\n * @returns The response body interpreted as JSON\r\n */\r\nexport async function requestAPI<T>(\r\n  endPoint = '',\r\n  init: RequestInit = {},\r\n  param: [string, string] = ['', ''],\r\n  param2: [string, string] = ['', '']\r\n): Promise<T> {\r\n  // Make request to Jupyter API\r\n  const settings = ServerConnection.makeSettings();\r\n\r\n  const requestUrl = URLExt.join(settings.baseUrl, 'climb-onyx-ui', endPoint);\r\n\r\n  let url = new URL(requestUrl);\r\n  if (param[0] !== '') {\r\n    url.searchParams.append(param[0], param[1]);\r\n  }\r\n  if (param2[0] !== '') {\r\n    url.searchParams.append(param2[0], param2[1]);\r\n  }\r\n\r\n  let response: Response;\r\n  try {\r\n    response = await ServerConnection.makeRequest(\r\n      url.toString(),\r\n      init,\r\n      settings\r\n    );\r\n  } catch (error) {\r\n    throw new ServerConnection.NetworkError(error as any);\r\n  }\r\n\r\n  let data: any = await response.text();\r\n\r\n  if (data.length > 0) {\r\n    try {\r\n      data = JSON.parse(data);\r\n    } catch (error) {\r\n      console.log('Not a JSON response body.', response);\r\n    }\r\n  }\r\n\r\n  if (!response.ok) {\r\n    throw new ServerConnection.ResponseError(response, data.message || data);\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nexport async function requestAPIResponse(\r\n  endPoint = '',\r\n  init: RequestInit = {},\r\n  param: [string, string] = ['', '']\r\n): Promise<Response> {\r\n  // Make request to Jupyter API\r\n  const settings = ServerConnection.makeSettings();\r\n\r\n  const requestUrl = URLExt.join(settings.baseUrl, 'climb-onyx-ui', endPoint);\r\n\r\n  let url = new URL(requestUrl);\r\n  if (param[0] !== '') {\r\n    url.searchParams.append(param[0], param[1]);\r\n  }\r\n\r\n  let response: Response;\r\n  try {\r\n    response = await ServerConnection.makeRequest(\r\n      url.toString(),\r\n      init,\r\n      settings\r\n    );\r\n  } catch (error) {\r\n    throw new ServerConnection.NetworkError(error as any);\r\n  }\r\n  return response;\r\n}\r\n","import { LabIcon } from '@jupyterlab/ui-components';\nimport CHAT_ICON from './../style/icons/dna.svg';\n\nexport const chatIcon = new LabIcon({\n  name: 'jitsi:chat',\n  svgstr: CHAT_ICON\n});\n","import {\r\n  JupyterFrontEnd,\r\n  JupyterFrontEndPlugin\r\n} from '@jupyterlab/application';\r\n\r\nimport {\r\n  ICommandPalette,\r\n  MainAreaWidget,\r\n  WidgetTracker,\r\n  showDialog,\r\n  Dialog\r\n} from '@jupyterlab/apputils';\r\n\r\nimport { IDocumentManager } from '@jupyterlab/docmanager';\r\nimport { HTMLViewer, IHTMLViewerTracker } from '@jupyterlab/htmlviewer';\r\n\r\nimport { ILauncher } from '@jupyterlab/launcher';\r\n\r\nimport { requestAPI, requestAPIResponse } from './handler';\r\nimport { ReactAppWidget } from './App';\r\nimport { chatIcon } from './icon';\r\nimport { Widget } from '@lumino/widgets';\r\n\r\nclass OpenS3FileWidget extends Widget {\r\n  constructor() {\r\n    const body = document.createElement('div');\r\n    const existingLabel = document.createElement('label');\r\n    existingLabel.textContent = 'S3 file name:';\r\n\r\n    const input = document.createElement('input');\r\n    input.value = '';\r\n    input.placeholder = 's3://example-bucket/example-file.html';\r\n\r\n    body.appendChild(existingLabel);\r\n    body.appendChild(input);\r\n\r\n    super({ node: body });\r\n  }\r\n\r\n  get inputNode() {\r\n    return this.node.getElementsByTagName('input')[0];\r\n  }\r\n\r\n  getValue() {\r\n    return this.inputNode.value;\r\n  }\r\n}\r\n\r\n/**\r\n * Initialization data for the climb-onyx-ui extension.\r\n */\r\nconst plugin: JupyterFrontEndPlugin<void> = {\r\n  id: 'climb-onyx-ui:plugin',\r\n  description: 'climb-onyx-ui.',\r\n  autoStart: true,\r\n  optional: [ILauncher, IHTMLViewerTracker],\r\n  requires: [ICommandPalette, IDocumentManager],\r\n  activate: (\r\n    app: JupyterFrontEnd,\r\n    palette: ICommandPalette,\r\n    documentManager: IDocumentManager,\r\n    launcher: ILauncher | null,\r\n    htmlTracker: IHTMLViewerTracker | null\r\n  ) => {\r\n    console.log('JupyterLab extension @climb-onyx-ui is activated!');\r\n\r\n    const command = 'onyx_extension';\r\n    const s3_command = 's3_onyx_extension';\r\n    const category = 'Onyx';\r\n\r\n    let version = '';\r\n\r\n    requestAPI<any>('version')\r\n      .then(data => {\r\n        version = data['version'];\r\n        console.log(`JupyterLab extension version: ${version}`);\r\n      })\r\n      .catch(_ => {});\r\n\r\n    const s3_open_function = (s3_link: string) => {\r\n      requestAPI<any>('s3', {}, ['s3location', s3_link])\r\n        .then(data => {\r\n          documentManager.open(data['temp_file']);\r\n        })\r\n        .catch(reason => {\r\n          console.error(\r\n            `The climb-onyx-ui server extension appears to be missing.\\n${reason}`\r\n          );\r\n        });\r\n    };\r\n\r\n    const write_file_function = (path: string, content: string) => {\r\n      const dataToSend = { content: content };\r\n      requestAPI<any>('file-write',  {\r\n        body: JSON.stringify(dataToSend),\r\n        method: 'POST'\r\n      }, ['path', path])\r\n        .then(data => {\r\n          documentManager.open(data['path']);\r\n        })\r\n        .catch(reason => {\r\n          console.error(\r\n            `The climb-onyx-ui server extension appears to be missing.\\n${reason}`\r\n          );\r\n        });\r\n    };\r\n\r\n    const routeHandler = async (route: string): Promise<Response> => {\r\n      return requestAPIResponse('reroute', {}, ['route', route]);\r\n    };\r\n\r\n    // Create a single widget\r\n    let widget: MainAreaWidget<ReactAppWidget>;\r\n\r\n    app.commands.addCommand(command, {\r\n      label: 'Onyx',\r\n      caption: 'Onyx',\r\n      icon: chatIcon,\r\n      execute: () => {\r\n        if (!widget || widget.disposed) {\r\n          const content = new ReactAppWidget(\r\n            routeHandler,\r\n            s3_open_function,\r\n            write_file_function,\r\n            version\r\n          );\r\n          content.addClass('onyx-Widget');\r\n          widget = new MainAreaWidget({ content });\r\n          widget.title.label = 'Onyx';\r\n          widget.title.closable = true;\r\n        }\r\n        if (!tracker.has(widget)) {\r\n          tracker.add(widget);\r\n        }\r\n        if (!widget.isAttached) {\r\n          // Attach the widget to the main work area if it's not there\r\n          app.shell.add(widget, 'main');\r\n        }\r\n\r\n        // Activate the widget\r\n        app.shell.activateById(widget.id);\r\n      }\r\n    });\r\n\r\n    palette.addItem({ command, category: category });\r\n\r\n    if (launcher) {\r\n      launcher.add({\r\n        command: command,\r\n        category: category\r\n      });\r\n    }\r\n\r\n    app.commands.addCommand(s3_command, {\r\n      label: 'Onyx open s3 document',\r\n      caption: 'Onyx open s3 document',\r\n      icon: chatIcon,\r\n      execute: () => {\r\n        showDialog({\r\n          body: new OpenS3FileWidget(),\r\n          buttons: [Dialog.cancelButton(), Dialog.okButton({ label: 'GO' })],\r\n          focusNodeSelector: 'input',\r\n          title: 'Open site'\r\n        })\r\n          .then(result => {\r\n            if (result.button.label === 'Cancel') {\r\n              return;\r\n            }\r\n            if (!result.value) {\r\n              return;\r\n            }\r\n            const s3_link = result.value;\r\n            s3_open_function(s3_link);\r\n          })\r\n          .catch(reason => {\r\n            console.error(\r\n              `The climb-onyx-ui server extension appears to be missing.\\n${reason}`\r\n            );\r\n          });\r\n      }\r\n    });\r\n\r\n    palette.addItem({ command: s3_command, category: category });\r\n\r\n    if (launcher) {\r\n      launcher.add({\r\n        command: s3_command,\r\n        category: category\r\n      });\r\n    }\r\n\r\n    if (htmlTracker) {\r\n      htmlTracker.widgetAdded.connect((sender, panel: HTMLViewer) => {\r\n        panel.trusted = true;\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nconst tracker = new WidgetTracker<MainAreaWidget<ReactAppWidget>>({\r\n  namespace: 'climb-onyx-ui'\r\n});\r\n\r\nexport default plugin;\r\n"],"names":[],"sourceRoot":""}